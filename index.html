<script>
(function () {
  const app = document.getElementById('app');
  const BASE = '/fintrust';

  // Cache f√ºr geladene Daten (nur 1x fetch)
  const store = {
    loaded: false,
    assets: [],
    risks: [],
    radar: [],
    error: null
  };

  function parseHash() {
    // Erwartet: #/radar?severity=warning oder #/assets/crypto/btc
    const raw = (location.hash || '#/').replace(/^#/, '');
    const [p, qs] = raw.split('?');
    let path = p || '/';
    if (!path.startsWith('/')) path = '/' + path;

    const params = new URLSearchParams(qs || '');
    return { path, params };
  }

  async function loadOnce() {
    if (store.loaded || store.error) return;

    async function loadJSON(url) {
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error('Load failed: ' + url);
      return res.json();
    }

    try {
      const [assets, risks, radar] = await Promise.all([
        loadJSON(BASE + '/data/assets.json'),
        loadJSON(BASE + '/data/risk_profiles.json'),
        loadJSON(BASE + '/data/radar_events.json')
      ]);
      store.assets = assets;
      store.risks = risks;
      store.radar = radar;
      store.loaded = true;
    } catch (e) {
      store.error = e;
    }
  }

  function sevRank(sev) {
    // wichtigstes zuerst
    if (sev === 'critical') return 0;
    if (sev === 'warning') return 1;
    if (sev === 'info') return 2;
    return 9;
  }

  function renderHome() {
    const
